{"version":3,"file":"js/bundle.js","mappings":"mBAAA,IAAIA,EAAQ,CAAC,SAAU,SAAU,OAAQ,MAAO,OAAQ,QAAS,QCA7DC,EAAQ,CAAC,IAAK,KAAM,KAAM,IAAK,IAAK,KAAM,KCO1CC,EAAU,CAAC,EAMJC,EAAW,SAAUC,EAAQC,GACpCH,EAAQE,GAAUC,CACtB,ECRAF,EAAS,SHNM,SAAUG,EAAMC,GAC3B,GAAY,IAARA,EACA,MAAO,CAAC,WAAY,aACxB,IAAIC,EAAOR,EAAMS,KAAKC,MAAMH,EAAM,IAGlC,OAFID,EAAO,IACPE,GAAQ,KACL,CAACF,EAAO,IAAME,EAAO,OAAQ,MAAQF,EAAO,IAAME,EAC7D,IGAAL,EAAS,SFPM,SAAUG,EAAMC,GAC3B,GAAY,IAARA,EACA,MAAO,CAAC,KAAM,OAClB,IAAIC,EAAOP,KAASM,EAAM,IAC1B,MAAO,CAACD,EAAO,IAAME,EAAO,IAAUF,EAAO,IAAME,EAAO,IAC9D,IGLoB,ICDpB,MAEIG,cACIC,KAAKC,IAAM,iCACf,CAEAC,iBACI,MAAMC,QAAiBC,MAAMJ,KAAKC,KAElC,aADoBE,EAASE,MAEjC,CAEDH,eAAeI,GACX,MAAMC,QAAYH,MAAMJ,KAAKC,IAAK,CACjCO,OAAQ,OACRC,KAAMH,IAEDI,QAAaH,EAAIF,OACvBM,QAAQC,IAAIF,EACd,CAEFR,iBAAiBW,GACjB,MAAMN,QAAYH,MAAM,wBAAyB,CAC5CU,QAAS,CACL,eAAgB,oBAEpBN,OAAQ,WAGNE,QAAaH,EAAIF,OACvBM,QAAQC,IAAIF,EAEZ,GC5BJK,SAASC,iBAAiB,oBAAoB,MACjC,GAAI,OACZC,aAAa,IAGlBF,SAASG,eAAe,aACvBF,iBAAiB,UAAUG,IAE1B,MAAMC,EAAQL,SAASG,eAAe,SAAUG,MAC1CC,EAASP,SAASG,eAAe,UAAUG,MAC3CE,EAAOR,SAASG,eAAe,QAAQG,MACvCG,EAAQT,SAASG,eAAe,SAASO,MAEzCC,EAAW,IAAIC,SACrBD,EAASE,OAAO,QAASJ,EAAM,IAC/BE,EAASE,OAAO,QAASR,GACzBM,EAASE,OAAO,SAAUN,GAC1BI,EAASE,OAAO,OAAQL,GAExB,MAAMM,EAAK,GAAI,MACfA,EAAGC,YAAYJ,GACfG,EAAGE,cAAc,iBAAkB,UAAW,KAE7CZ,EAAEa,gBAAgB,IAGrBjB,SAASG,eAAe,eACvBF,iBAAiB,SAASG,IACzB,GAAIA,EAAEc,OAAOC,UAAUC,SAAS,UAAW,CACzC,MAAMN,EAAK,GAAI,OACfA,EAAGO,WAAWjB,EAAEc,OAAOI,aAAa,QACpCR,EAAGE,cAAc,eAAgB,SAAU,IAC7C,CACCZ,EAAEa,gBAAgB,G","sources":["webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/lang/en_US.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/lang/zh_CN.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/register.js","webpack://javascript-fullstack-simple/./node_modules/timeago.js/esm/index.js","webpack://javascript-fullstack-simple/./frontend/UI.js","webpack://javascript-fullstack-simple/./frontend/services/BookService.js","webpack://javascript-fullstack-simple/./frontend/app.js"],"sourcesContent":["var EN_US = ['second', 'minute', 'hour', 'day', 'week', 'month', 'year'];\nexport default function (diff, idx) {\n    if (idx === 0)\n        return ['just now', 'right now'];\n    var unit = EN_US[Math.floor(idx / 2)];\n    if (diff > 1)\n        unit += 's';\n    return [diff + \" \" + unit + \" ago\", \"in \" + diff + \" \" + unit];\n}\n//# sourceMappingURL=en_US.js.map","var ZH_CN = ['秒', '分钟', '小时', '天', '周', '个月', '年'];\nexport default function (diff, idx) {\n    if (idx === 0)\n        return ['刚刚', '片刻后'];\n    var unit = ZH_CN[~~(idx / 2)];\n    return [diff + \" \" + unit + \"\\u524D\", diff + \" \" + unit + \"\\u540E\"];\n}\n//# sourceMappingURL=zh_CN.js.map","/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n/**\n * All supported locales\n */\nvar Locales = {};\n/**\n * register a locale\n * @param locale\n * @param func\n */\nexport var register = function (locale, func) {\n    Locales[locale] = func;\n};\n/**\n * get a locale, default is en_US\n * @param locale\n * @returns {*}\n */\nexport var getLocale = function (locale) {\n    return Locales[locale] || Locales['en_US'];\n};\n//# sourceMappingURL=register.js.map","/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\nimport en_US from './lang/en_US';\nimport zh_CN from './lang/zh_CN';\nimport { register } from './register';\nregister('en_US', en_US);\nregister('zh_CN', zh_CN);\nexport { format } from './format';\nexport { render, cancel } from './realtime';\nexport { register };\n//# sourceMappingURL=index.js.map","import  BookService  from './services/BookService';\r\nconst bookService = new BookService();\r\n\r\nimport {format} from 'timeago.js';\r\n\r\n  class UI {\r\n  \r\n  async renderBooks() { \r\n    const books = await bookService.getBooks();\r\n    const booksCardContainer = document.getElementById('books-cards');\r\n    booksCardContainer.innerHTML = '';\r\n    books.forEach ((book) => {\r\n      const div = document.createElement(\"div\");\r\n      div.className = '';\r\n      div.innerHTML = `\r\n            <div class= \"card m-2\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-4\">\r\n            <img src=\"http://localhost:3000${book.imagePath}\" alt=\"\" class=\"img-fluid/>\r\n            </div>\r\n            <div class=\"col-md-8\">\r\n            <div class=\"card-blok px-2\">\r\n              <h4 class=\"card-title\">${book.title}</h4>\r\n              <p class=\"card-text\">${book.author}</p>\r\n              <a href=\"#\" class=\"btn btn-danger delete\" __id=\"${book._id}\">x</a>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"card-footer\">\r\n            ${format (book.created_at)}\r\n            </div>\r\n          </div>\r\n       `;\r\n       booksCardContainer.appendChild(div);\r\n     });\r\n  }\r\n  \r\n  async addANewBook(book) {\r\n    await bookService.postBook(book);\r\n    this.clearBookForm();\r\n    this.renderBooks();\r\n  }\r\n\r\n  clearBookForm() {\r\n    document.getElementById('book-form').reset();\r\n\r\n  }\r\n\r\n  renderMessage(message, colorMessage, secondsToremove) { \r\n    const div = document.createElement('div');\r\n    div.className = `alert alert-${colorMessage} message`;\r\n    div.appendChild(document.createTextNode(message));\r\n\r\n    const container = document.querySelector('.col-md-4');\r\n    const BookForm = document.querySelector('#book-form');\r\n\r\n    container.insertBefore(div, BookForm);\r\n    setTimeout(() => {\r\n        document.querySelector('.message').remove();\r\n    }, secondsToremove);\r\n    \r\n  }\r\n\r\n async deleteBook(bookId) { \r\n  await bookService.deleteBook(bookId);\r\n  this.renderBooks();\r\n }\r\n\r\n}\r\n","class BookService {\r\n\r\n    constructor() {\r\n        this.URI = 'http://localhost:3000/api/books';\r\n    }\r\n\r\n    async getBooks() {\r\n        const response = await fetch(this.URI);\r\n        const books = await response.json();\r\n        return books;\r\n    }\r\n\r\n   async postBook(book) {\r\n       const res = await fetch(this.URI, {\r\n        method: 'POST',\r\n        body: book\r\n       });\r\n       const data = await res.json();\r\n       console.log(data)\r\n     }\r\n\r\n   async deleteBook(bookId) {\r\n   const res = await fetch('${this.URI}/${bookId}', {\r\n        headers: {\r\n            'content-type': 'application/json'\r\n        },\r\n        method: 'DELETE'\r\n\r\n    });\r\n    const data = await res.json(); \r\n    console.log(data)\r\n\r\n    }\r\n}\r\n\r\n   export default BookService;","import \"./styles/app.css\";\r\n\r\nimport UI from './UI'; \r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  const ui = new '.UI'();\r\n  ui.renderBooks();\r\n});\r\n\r\ndocument.getElementById('book-form')\r\n.addEventListener('submit', e => {\r\n\r\n  const title = document.getElementById('title'). value;\r\n  const author = document.getElementById('author').value;\r\n  const isbn = document.getElementById('isbn').value;\r\n  const image = document.getElementById(\"image\").files;\r\n\r\n  const formData = new FormData();\r\n  formData.append(\"image\", image[0]);\r\n  formData.append(\"title\", title);\r\n  formData.append(\"author\", author);\r\n  formData.append(\"isbn\", isbn);\r\n\r\n  const ui = new '.UI'();\r\n  ui.addANewBook(formData);\r\n  ui.renderMessage('New Book Added', 'success', 3000);\r\n\r\n   e.preventDefault();\r\n});\r\n\r\ndocument.getElementById('books-cards')\r\n.addEventListener('click', e => {\r\n  if (e.target.classList.contains('delete')) {\r\n    const ui = new './UI'()\r\n    ui.deleteBook(e.target.getAttribute('_id'));\r\n    ui.renderMessage('Book Removed', 'danger', 2000);\r\n  }\r\n   e.preventDefault();\r\n\r\n});\r\n"],"names":["EN_US","ZH_CN","Locales","register","locale","func","diff","idx","unit","Math","floor","constructor","this","URI","async","response","fetch","json","book","res","method","body","data","console","log","bookId","headers","document","addEventListener","renderBooks","getElementById","e","title","value","author","isbn","image","files","formData","FormData","append","ui","addANewBook","renderMessage","preventDefault","target","classList","contains","deleteBook","getAttribute"],"sourceRoot":""}